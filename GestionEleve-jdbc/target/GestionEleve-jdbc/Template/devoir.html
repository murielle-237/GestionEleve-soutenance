<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste des Devoirs</title>
    <link rel="stylesheet" th:href="@{/Template/style40.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar">
        <h2>smartschool</h2>
        <div class="sidebar-menu">
           <a th:href="@{/dashboard}"><div class="menu-item"><i class="fas fa-tachometer-alt"></i> Dashboard</div></a>
           <a th:href="@{/emploidetemps}"><div class="menu-item"><i class="fas fa-user-check"></i> Emploi du temps</div></a>
           <a th:href="@{/note}"><div class="menu-item"><i class="fas fa-book"></i> Notes</div></a>
           <a th:href="@{/devoir}"><div class="menu-item active"><i class="fas fa-users"></i> Devoirs</div></a>
           <a th:href="@{/classe}"><div class="menu-item"><i class="fas fa-chart-bar"></i> Salle</div></a>
           <a th:href="@{/bulettin}"><div class="menu-item"><i class="fas fa-cog"></i> Mon bulletin</div></a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="navbar">
            <h1>Liste des Devoirs</h1>
            <div class="user-info">
                <div class="notifications">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </div>
                <div class="user-avatar">AB</div>
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Matière</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="table-devoirs">
                <!-- Les matières seront injectées par JavaScript ou Thymeleaf -->
                <tr th:each="devoir : ${devoirs}">
                    <td th:text="${devoir.matiere}"></td>
                    <td>
                        <button th:onclick="'afficherDevoir(\'' + ${devoir.matiere} + '\', \'' + ${devoir.titre} + '\', \'' + ${devoir.desc} + '\', \'' + ${devoir.date} + '\', \'' + ${devoir.fichier} + '\')'">Voir le devoir</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Bloc affichage devoir -->
        <div id="details-devoir" class="details-devoir" style="display:none;">
            <h3 id="titre-devoir"></h3>
            <p id="description-devoir"></p>
            <p><strong>Date limite :</strong> <span id="date-devoir"></span></p>
            <a id="lien-telechargement" href="" download>Télécharger le fichier</a>
        </div>
    </main>
</div>

<script th:inline="javascript">
/*<![CDATA[*/
function afficherDevoir(matiere, titre, description, date, fichier) {
    document.getElementById('titre-devoir').textContent = matiere + " - " + titre;
    document.getElementById('description-devoir').textContent = description;
    document.getElementById('date-devoir').textContent = date;
    const lien = document.getElementById('lien-telechargement');
    lien.href = /*[[${devoir.fichier}]]*/ fichier;
    lien.style.display = 'inline-block';
    document.getElementById('details-devoir').style.display = 'block';
}
/*]]>*/
</script>
<!-- Ajout du lien de téléchargement dans le tableau -->
<script th:inline="javascript">
/*<![CDATA[*/
// Rien à ajouter ici, le lien est dans le tableau ci-dessous
/*]]>*/
</script>
</body>
</html>
